/**
 * @brief Implements generic sensor data serialization
 *
 * @author John Madden <jmadden173@pm.me>
 * @date 2025-06-13
 */

syntax = "proto3";

enum SensorType {
  NONE = 0;

  /** Onboard power measurements */
  POWER_VOLTAGE = 1;
  POWER_CURRENT = 2;

  /** Teros12 measurements */
  TEROS12_VWC = 3;
  TEROS12_TEMP = 4;
  TEROS12_EC = 5;

  /** Phytos31 measurements */
  PHYTOS31_VOLTAGE = 6;
  PHYTOS31_LEAF_WETNESS = 7;

  /** Bme280 measurements */
  BME280_PRESSURE = 8;
  BME280_TEMP = 9;
  BME280_HUMIDITY = 10;

  /** Teros21 measurements */
  TEROS21_MATRIC_POT = 11;
  TEROS21_TEMP = 12;

  /** Sen0308 measurements */
  SEN0308_VOLTAGE = 13;
  SEN0308_HUMIDITY = 14;

  /** Sen0257 measurements */
  SEN0257_VOLTAGE = 15;
  SEN0257_PRESSURE = 16;
  
  /** YFS210C measurements */
  YFS210C_FLOW = 17;
}

message Metadata {
  // id of the cell measured
  uint32 cell_id = 1;
  // id of the logging device
  uint32 logger_id = 2;
  // timestamp of the measurement
  uint32 ts = 3;
}

message SensorMeasurement {
  /** Metadata for the measurement */
  Metadata meta = 1;

  /** Type of sensor measurement */
  SensorType type = 2;

  oneof value {
    uint64 unsigned_int = 3; 
    sint64 signed_int = 4;
    double decimal = 5;
  }
}

message RepeatedSensorMeasurements {
  /** Metadata for all measurements */
  Metadata meta = 1;

  /** Type of sensor measurements */
  SensorType type = 2;

  /** List of sensor measurements */
  repeated SensorMeasurement measurements = 3;
}
